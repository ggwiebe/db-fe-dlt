-- Databricks notebook source
-- MAGIC %python
-- MAGIC display(sql("""select *, concat('Q', d_qoy) as qoy
-- MAGIC                  from store_sales
-- MAGIC                  join date_dim on ss_sold_date_sk = d_date_sk
-- MAGIC                  join item on ss_item_sk = i_item_sk"""
-- MAGIC            ).groupBy("i_category")
-- MAGIC             .pivot("qoy")
-- MAGIC             .agg(round(sum("ss_sales_price")/1000000,2))
-- MAGIC )

-- COMMAND ----------

-- MAGIC %md ## Results from query should look like this:  
-- MAGIC   
-- MAGIC ```
-- MAGIC +-----------+----+----+----+----+
-- MAGIC | i_category|  Q1|  Q2|  Q3|  Q4|
-- MAGIC +-----------+----+----+----+----+
-- MAGIC |      Books|1.58|1.50|2.84|4.66|
-- MAGIC |      Women|1.41|1.36|2.54|4.16|
-- MAGIC |      Music|1.50|1.44|2.66|4.36|
-- MAGIC |   Children|1.54|1.46|2.74|4.51|
-- MAGIC |     Sports|1.47|1.40|2.62|4.30|
-- MAGIC |      Shoes|1.51|1.48|2.68|4.46|
-- MAGIC |    Jewelry|1.45|1.39|2.59|4.25|
-- MAGIC |       null|0.04|0.04|0.07|0.13|
-- MAGIC |Electronics|1.56|1.49|2.77|4.57|
-- MAGIC |       Home|1.57|1.51|2.79|4.60|
-- MAGIC |        Men|1.60|1.54|2.86|4.71|
-- MAGIC +-----------+----+----+----+----+
-- MAGIC ```
